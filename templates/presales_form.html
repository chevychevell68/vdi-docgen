{% extends "base.html" %}
{% block content %}
<h1 class="h3 mb-3">Presales Questionnaire</h1>
<p class="help-text mb-4">Fill out the details below.</p>

<form method="POST" action="/presales/submit" id="presalesForm">
  <div class="mb-3">
    <label class="form-label required">Voice of the Customer â€” Objectives / Outcomes</label>
    <textarea class="form-control" name="voc" rows="5" placeholder="Objectives, success criteria, constraints."></textarea>
  </div>

  <h2 class="h5 section-title">Environment & Scope</h2>
  <div class="mb-3">
    <label class="form-label required">Deployment Scope</label>
    <select class="form-select" name="pod_scope" id="pod_scope">
      <option value="single">Single pod</option>
      <option value="multi">Multi-pod</option>
    </select>
  </div>

  <div class="mb-3">
    <label class="form-label required">Include Test/Dev Environments?</label>
    <select class="form-select" name="include_test_dev" id="include_test_dev">
      <option value="no">No</option>
      <option value="yes">Yes</option>
    </select>
  </div>

  <div class="mb-3" id="test_dev_notes_group" style="display:none;">
    <label class="form-label">Test/Dev Notes</label>
    <textarea class="form-control" name="test_dev_notes" rows="3"></textarea>
  </div>

  <h2 class="h5 section-title">Host / Cluster Configuration</h2>
  <div class="mb-3">
    <label class="form-label required">CPU per Host</label>
    <input type="text" class="form-control" name="cpu_per_host">
  </div>
  <div class="mb-3">
    <label class="form-label required">RAM per Host</label>
    <input type="text" class="form-control" name="ram_per_host">
  </div>

  <h2 class="h5 section-title">Storage</h2>
  <div class="mb-3">
    <label class="form-label required">Primary Storage Type</label>
    <select class="form-select" name="storage_type" id="storage_type">
      <option value="vsan">vSAN</option>
      <option value="pure">Pure Storage</option>
      <option value="other">Other</option>
    </select>
  </div>
  <div class="mb-3 storage-extra">
    <label class="form-label">Storage Vendor</label>
    <input type="text" class="form-control" name="storage_vendor">
  </div>
  <div class="mb-3 storage-extra">
    <label class="form-label">Storage Model</label>
    <input type="text" class="form-control" name="storage_model">
  </div>
  <div class="mb-3 storage-extra">
    <label class="form-label">Usable Capacity (TB)</label>
    <input type="text" class="form-control" name="storage_capacity_tb">
  </div>

  <h2 class="h5 section-title">Networking & Load Balancing</h2>
  <div class="mb-3">
    <label class="form-label required">Load Balancer</label>
    <select class="form-select" name="load_balancer">
      <option value="F5 BIG-IP">F5 BIG-IP</option>
      <option value="Avi / NSX ALB">Avi / NSX ALB</option>
      <option value="Netscaler (Citrix ADC)">Netscaler (Citrix ADC)</option>
      <option value="Other / TBD">Other / TBD</option>
      <option value="None">None</option>
    </select>
  </div>

  <h2 class="h5 section-title">Access & Identity</h2>
  <div class="mb-3">
    <label class="form-label required">Integrate with 3rd-party IdP?</label>
    <select class="form-select" name="idp_integrate" id="idp_integrate">
      <option value="no">No</option>
      <option value="yes">Yes</option>
    </select>
  </div>
  <div class="mb-3" id="idp_provider_group" style="display:none;">
    <label class="form-label">IdP Provider</label>
    <input type="text" class="form-control" name="idp_provider">
  </div>

  <div class="d-flex gap-2">
    <button class="btn btn-primary" type="submit">Review Submission</button>
    <a class="btn btn-outline-secondary" href="/">Reset</a>
  </div>
</form>

<script>
  function toggleTestDev() {
    const sel = document.getElementById('include_test_dev');
    const grp = document.getElementById('test_dev_notes_group');
    grp.style.display = sel.value === 'yes' ? 'block' : 'none';
  }
  function toggleStorage() {
    const sel = document.getElementById('storage_type');
    const extras = document.querySelectorAll('.storage-extra');
    const showExtras = sel.value !== 'vsan';
    extras.forEach(el => el.style.display = showExtras ? 'block' : 'none');
  }
  function toggleIdP() {
    const sel = document.getElementById('idp_integrate');
    const grp = document.getElementById('idp_provider_group');
    grp.style.display = sel.value === 'yes' ? 'block' : 'none';
  }
  document.getElementById('include_test_dev').addEventListener('change', toggleTestDev);
  document.getElementById('storage_type').addEventListener('change', toggleStorage);
  document.getElementById('idp_integrate').addEventListener('change', toggleIdP);
  toggleTestDev(); toggleStorage(); toggleIdP();
</script>
{% endblock %}
