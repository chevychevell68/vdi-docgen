{% extends "base.html" %}
{% block title %}Presales Discovery{% endblock %}

{% block content %}
<h1 class="mb-4">{{ editing and 'Edit Submission' or 'Presales Discovery Form' }}</h1>

<form method="post" class="row g-3" style="max-width: 980px;">
  {% if form.entry_id %}
    <input type="hidden" name="entry_id" value="{{ form.entry_id }}">
    <div class="alert alert-warning">
      Editing entry <strong>{{ form.entry_id }}</strong>. Saving will update history.
    </div>
  {% endif %}

  <!-- =========================
       Customer / Opportunity
  ========================== -->
  <div class="col-12">
    <h5 class="mt-2">Customer & Opportunity</h5>
    <hr class="mt-1">
  </div>

  <div class="col-md-6">
    <label class="form-label">Company Name <span class="text-danger">*</span></label>
    <input name="company_name" class="form-control" placeholder="Acme Corporation" value="{{ form.company_name or '' }}" required>
  </div>

  <div class="col-md-6">
    <label class="form-label">Customer Contact Name</label>
    <input name="customer_name" class="form-control" placeholder="Jane Doe" value="{{ form.customer_name or '' }}">
  </div>

  <div class="col-md-6">
    <label class="form-label">Salesforce Opportunity Name</label>
    <input name="sf_opportunity_name" class="form-control" placeholder="FY25 – Acme VDI Expansion" value="{{ form.sf_opportunity_name or '' }}">
  </div>

  <div class="col-md-6">
    <label class="form-label">Salesforce Opportunity URL</label>
    <input name="sf_opportunity_url" class="form-control" placeholder="https://your-instance.lightning.force.com/lightning/r/Opportunity/XXXXXXXXXXXX/view" value="{{ form.sf_opportunity_url or '' }}">
  </div>

  <div class="col-md-4">
    <label class="form-label">IR Number</label>
    <input name="ir_number" class="form-control" placeholder="IR-12345" value="{{ form.ir_number or '' }}">
  </div>

  <div class="col-12">
    <label class="form-label">Voice of Customer / Notes</label>
    <textarea name="voc" class="form-control" rows="2" placeholder="Key drivers, success criteria, constraints...">{{ form.voc or '' }}</textarea>
  </div>

  <!-- =========================
       Existing VDI
  ========================== -->
  <div class="col-12">
    <h5 class="mt-4">Existing VDI</h5>
    <hr class="mt-1">
  </div>

  <div class="col-md-6">
    <label class="form-label">Existing VDI Platform</label>
    <input name="existing_vdi" class="form-control" placeholder="None / Citrix / VMware / Azure Virtual Desktop..." value="{{ form.existing_vdi or '' }}">
  </div>

  <div class="col-12">
    <label class="form-label">Pain Points</label>
    <textarea name="existing_vdi_pain" class="form-control" rows="2" placeholder="Performance issues, image sprawl, profile bloat, login delays...">{{ form.existing_vdi_pain or '' }}</textarea>
  </div>

  <!-- =========================
       Users & Scope
  ========================== -->
  <div class="col-12">
    <h5 class="mt-4">Users & Scope</h5>
    <hr class="mt-1">
  </div>

  <div class="col-md-4">
    <label class="form-label">Total Users <span class="text-danger">*</span></label>
    <input name="total_users" type="number" min="1" class="form-control" placeholder="1000" value="{{ form.total_users or '' }}" required>
  </div>

  <div class="col-md-4">
    <label class="form-label">Concurrent Users <span class="text-danger">*</span></label>
    <input name="concurrent_users" type="number" min="1" class="form-control" placeholder="600" value="{{ form.concurrent_users or '' }}" required>
  </div>

  <div class="col-md-4">
    <label class="form-label">Number of Datacenters</label>
    <input name="num_datacenters" type="number" min="0" class="form-control" placeholder="2" value="{{ form.num_datacenters or '' }}">
  </div>

  <div class="col-12">
    <label class="form-label">Datacenter Details</label>
    <input name="datacenters_detail" class="form-control" placeholder="STL (primary), PHX (DR)" value="{{ form.datacenters_detail or '' }}">
  </div>

  <div class="col-md-6">
    <label class="form-label">Deployment Type</label>
    <input name="deployment_type" class="form-control" placeholder="On-prem / Cloud / Hybrid" value="{{ form.deployment_type or '' }}">
  </div>

  <div class="col-md-6">
    <label class="form-label"># of Personas</label>
    <input name="num_personas" type="number" min="1" class="form-control" placeholder="3" value="{{ form.num_personas or '' }}">
  </div>

  <div class="col-12">
    <label class="form-label">Main Use Case</label>
    <input name="main_use_cases" class="form-control" placeholder="Task workers with Office, Teams, SAP GUI" value="{{ form.main_use_cases or '' }}">
  </div>

  <div class="col-12">
    <label class="form-label">Secondary Use Case #2</label>
    <input name="secondary_use_case_2" class="form-control" placeholder="Power users with Visual Studio and SQL tooling" value="{{ form.secondary_use_case_2 or '' }}">
  </div>

  <!-- =========================
       GPU
  ========================== -->
  <div class="col-12">
    <h5 class="mt-4">GPU</h5>
    <hr class="mt-1">
  </div>

  <div class="col-md-3 d-flex align-items-end">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" id="gpu_required" name="gpu_required" {% if form.gpu_required %}checked{% endif %}>
      <label class="form-check-label" for="gpu_required">GPU Required? <strong>Yes</strong></label>
    </div>
  </div>

  <div class="col-md-3">
    <label class="form-label">GPU Users</label>
    <input name="gpu_users" type="number" min="0" class="form-control" placeholder="50" value="{{ form.gpu_users or '' }}">
  </div>

  <div class="col-md-3">
    <label class="form-label">VRAM per User (GB)</label>
    <input name="gpu_vram_per_user" type="number" min="0" step="0.5" class="form-control" placeholder="2" value="{{ form.gpu_vram_per_user or '' }}">
  </div>

  <div class="col-md-12">
    <label class="form-label">GPU Use Case</label>
    <input name="gpu_use_case" class="form-control" placeholder="CAD, Revit, 3D rendering, ML tooling..." value="{{ form.gpu_use_case or '' }}">
  </div>

  <!-- =========================
       Images & Apps
  ========================== -->
  <div class="col-12">
    <h5 class="mt-4">Images & Applications</h5>
    <hr class="mt-1">
  </div>

  <div class="col-md-4">
    <label class="form-label"># of Base Images</label>
    <input name="num_images" type="number" min="1" class="form-control" placeholder="2" value="{{ form.num_images or '' }}">
  </div>

  <div class="col-md-8">
    <label class="form-label">Gold Image Source</label>
    <input name="gold_image_source" class="form-control" placeholder="Existing on-prem image / Build new / Marketplace..." value="{{ form.gold_image_source or '' }}">
  </div>

  <div class="col-12">
    <label class="form-label d-block">Profile Management (multi-select)</label>
    <div class="form-check form-check-inline">
      <input class="form-check-input" type="checkbox" name="profile_mgmt[]" id="pm_fslogix" value="FSLogix" {% if 'FSLogix' in (form.profile_mgmt or []) %}checked{% endif %}>
      <label class="form-check-label" for="pm_fslogix">FSLogix</label>
    </div>
    <div class="form-check form-check-inline">
      <input class="form-check-input" type="checkbox" name="profile_mgmt[]" id="pm_dem" value="DEM" {% if 'DEM' in (form.profile_mgmt or []) %}checked{% endif %}>
      <label class="form-check-label" for="pm_dem">VMware DEM</label>
    </div>
    <div class="form-check form-check-inline">
      <input class="form-check-input" type="checkbox" name="profile_mgmt[]" id="pm_other" value="Other" {% if 'Other' in (form.profile_mgmt or []) %}checked{% endif %}>
      <label class="form-check-label" for="pm_other">Other</label>
    </div>
  </div>

  <div class="col-12">
    <label class="form-label d-block">Virtual Apps (multi-select)</label>
    <div class="form-check form-check-inline">
      <input class="form-check-input" type="checkbox" name="virtual_apps[]" id="va_av" value="App Volumes" {% if 'App Volumes' in (form.virtual_apps or []) %}checked{% endif %}>
      <label class="form-check-label" for="va_av">App Volumes</label>
    </div>
    <div class="form-check form-check-inline">
      <input class="form-check-input" type="checkbox" name="virtual_apps[]" id="va_mdt" value="MSIX/App Attach" {% if 'MSIX/App Attach' in (form.virtual_apps or []) %}checked{% endif %}>
      <label class="form-check-label" for="va_mdt">MSIX / App Attach</label>
    </div>
    <div class="form-check form-check-inline">
      <input class="form-check-input" type="checkbox" name="virtual_apps[]" id="va_pack" value="Packaging" {% if 'Packaging' in (form.virtual_apps or []) %}checked{% endif %}>
      <label class="form-check-label" for="va_pack">Traditional Packaging</label>
    </div>
  </div>

  <div class="col-12">
    <label class="form-label">Required Applications</label>
    <textarea name="required_apps" class="form-control" rows="2" placeholder="Office, Teams (AV), Adobe Reader, SAP GUI, custom LOB apps...">{{ form.required_apps or '' }}</textarea>
  </div>

  <div class="col-12">
    <label class="form-label">WWT App Packaging Notes</label>
    <textarea name="wwt_app_packaging" class="form-control" rows="2" placeholder="Number of apps, complexity, sequencing...">{{ form.wwt_app_packaging or '' }}</textarea>
  </div>

  <!-- =========================
       Access & Identity
  ========================== -->
  <div class="col-12">
    <h5 class="mt-4">Access & Identity</h5>
    <hr class="mt-1">
  </div>

  <div class="col-md-3 d-flex align-items-end">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" id="remote_access" name="remote_access" {% if form.remote_access %}checked{% endif %}>
      <label class="form-check-label" for="remote_access">Remote Access Required? <strong>Yes</strong></label>
    </div>
  </div>

  <div class="col-md-3 d-flex align-items-end">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" id="mfa_required" name="mfa_required" {% if form.mfa_required %}checked{% endif %}>
      <label class="form-check-label" for="mfa_required">MFA Required? <strong>Yes</strong></label>
    </div>
  </div>

  <div class="col-md-6">
    <label class="form-label">MFA Solution</label>
    <input name="mfa_solution" class="form-control" placeholder="Okta Verify / Duo / Microsoft Authenticator..." value="{{ form.mfa_solution or '' }}">
  </div>

  <div class="col-md-3 d-flex align-items-end">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" id="smartcard" name="smartcard" {% if form.smartcard %}checked{% endif %}>
      <label class="form-check-label" for="smartcard">Smartcard? <strong>Yes</strong></label>
    </div>
  </div>

  <div class="col-md-9">
    <label class="form-label">IdP Provider</label>
    <input name="idp_provider" class="form-control" placeholder="Okta / Entra ID / Ping / ADFS..." value="{{ form.idp_provider or '' }}">
  </div>

  <!-- =========================
       Endpoints
  ========================== -->
  <div class="col-12">
    <h5 class="mt-4">Endpoints</h5>
    <hr class="mt-1">
  </div>

  <div class="col-md-6">
    <label class="form-label">Endpoint Provisioning</label>
    <input name="endpoint_provisioning" class="form-control" placeholder="Autopilot / Imaging / Manual..." value="{{ form.endpoint_provisioning or '' }}">
  </div>

  <div class="col-md-6">
    <label class="form-label">Endpoint Types</label>
    <input name="endpoint_types" class="form-control" placeholder="Windows, Thin Clients, Mac, BYOD..." value="{{ form.endpoint_types or '' }}">
  </div>

  <div class="col-md-6">
    <label class="form-label">Thin Client Management</label>
    <input name="thin_client_mgmt" class="form-control" placeholder="Teradici, Stratodesk, IGEL..." value="{{ form.thin_client_mgmt or '' }}">
  </div>

  <!-- =========================
       Directory & Core
  ========================== -->
  <div class="col-12">
    <h5 class="mt-4">Directory & Core</h5>
    <hr class="mt-1">
  </div>

  <div class="col-md-3 d-flex align-items-end">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" id="ad_exists" name="ad_exists" {% if form.ad_exists %}checked{% endif %}>
      <label class="form-check-label" for="ad_exists">Active Directory Exists? <strong>Yes</strong></label>
    </div>
  </div>

  <div class="col-md-3">
    <label class="form-label"># of Domains</label>
    <input name="num_domains" type="number" min="0" class="form-control" placeholder="1" value="{{ form.num_domains or '' }}">
  </div>

  <div class="col-md-3">
    <label class="form-label">VDI Domain Name</label>
    <input name="vd_domain_name" class="form-control" placeholder="vdi.acme.local" value="{{ form.vd_domain_name or '' }}">
  </div>

  <div class="col-md-3">
    <label class="form-label">Core Domain Name</label>
    <input name="core_domain_name" class="form-control" placeholder="acme.local" value="{{ form.core_domain_name or '' }}">
  </div>

  <!-- =========================
       Platform & Infra
  ========================== -->
  <div class="col-12">
    <h5 class="mt-4">Platform & Infrastructure</h5>
    <hr class="mt-1">
  </div>

  <div class="col-md-4">
    <label class="form-label">Platform</label>
    <input name="platform" class="form-control" placeholder="VMware / Citrix / AVD / Others" value="{{ form.platform or '' }}">
  </div>

  <div class="col-md-4">
    <label class="form-label">General Compute Cluster</label>
    <input name="general_compute_cluster" class="form-control" placeholder="Existing vSphere / New cluster..." value="{{ form.general_compute_cluster or '' }}">
  </div>

  <div class="col-md-4">
    <label class="form-label">Load Balancer</label>
    <input name="load_balancer" class="form-control" placeholder="F5 / NSX ALB / Nginx..." value="{{ form.load_balancer or '' }}">
  </div>

  <div class="col-md-3">
    <label class="form-label">Host CPU Cores</label>
    <input name="host_cpu_cores" type="number" min="0" class="form-control" placeholder="64" value="{{ form.host_cpu_cores or '' }}">
  </div>

  <div class="col-md-3">
    <label class="form-label">Host RAM (GB)</label>
    <input name="host_ram_gb" type="number" min="0" step="1" class="form-control" placeholder="512" value="{{ form.host_ram_gb or '' }}">
  </div>

  <div class="col-md-3">
    <label class="form-label"># of Hosts</label>
    <input name="hosts_count" type="number" min="0" class="form-control" placeholder="8" value="{{ form.hosts_count or '' }}">
  </div>

  <div class="col-md-3">
    <label class="form-label">vCPU per VM</label>
    <input name="vm_vcpu" type="number" min="1" class="form-control" placeholder="2" value="{{ form.vm_vcpu or '' }}">
  </div>

  <div class="col-md-3">
    <label class="form-label">VM RAM (GB)</label>
    <input name="vm_ram_gb" type="number" min="1" step="1" class="form-control" placeholder="8" value="{{ form.vm_ram_gb or '' }}">
  </div>

  <div class="col-md-3">
    <label class="form-label">vCPU:PCPU Ratio</label>
    <input name="vcpu_to_pcpu" type="number" min="1" class="form-control" placeholder="4" value="{{ form.vcpu_to_pcpu or '' }}">
  </div>

  <div class="col-md-3">
    <label class="form-label">Storage Type</label>
    <select name="storage_type" class="form-select">
      <option value="" {% if not form.storage_type %}selected{% endif %}>--</option>
      <option value="vSAN" {% if form.storage_type=='vSAN' %}selected{% endif %}>vSAN</option>
      <option value="Other" {% if form.storage_type=='Other' %}selected{% endif %}>Other</option>
    </select>
  </div>

  <div class="col-md-3">
    <label class="form-label">Storage Vendor / Model</label>
    <input name="storage_vendor_model" class="form-control" placeholder="Pure //X50, PowerStore 500..." value="{{ form.storage_vendor_model or '' }}">
  </div>

  <div class="col-md-3">
    <label class="form-label">Storage Protocol</label>
    <input name="storage_protocol" class="form-control" placeholder="vSAN / NFS / iSCSI / NVMeoF..." value="{{ form.storage_protocol or '' }}">
  </div>

  <div class="col-md-3">
    <label class="form-label">Usable Storage (GB)</label>
    <input name="storage_usable_gb" type="number" min="0" class="form-control" placeholder="20000" value="{{ form.storage_usable_gb or '' }}">
  </div>

  <div class="col-md-3">
    <label class="form-label">Base Image Size (GB)</label>
    <input name="base_image_gb" type="number" min="1" class="form-control" placeholder="40" value="{{ form.base_image_gb or '' }}">
  </div>

  <div class="col-md-3">
    <label class="form-label">vSAN Policy Factor</label>
    <input name="vsan_policy_factor" type="number" step="0.1" min="1.0" class="form-control" placeholder="2.0 (e.g., FTT=1 ~2.0)" value="{{ form.vsan_policy_factor or '' }}">
  </div>

  <div class="col-md-3">
    <label class="form-label">Writable Delta (GB)</label>
    <input name="delta_gb" type="number" step="1" min="0" class="form-control" placeholder="6" value="{{ form.delta_gb or '' }}">
  </div>

  <div class="col-md-3">
    <label class="form-label">Per-VM Overhead (GB)</label>
    <input name="per_vm_overhead_gb" type="number" step="0.5" min="0" class="form-control" placeholder="1" value="{{ form.per_vm_overhead_gb or '' }}">
  </div>

  <div class="col-md-3">
    <label class="form-label">Growth Factor</label>
    <input name="growth_factor" type="number" step="0.01" min="1.0" class="form-control" placeholder="1.10" value="{{ form.growth_factor or '' }}">
  </div>

  <div class="col-md-3">
    <label class="form-label">Mem Headroom (%)</label>
    <input name="mem_headroom_pct" type="number" step="0.01" min="0" max="1" class="form-control" placeholder="0.20" value="{{ form.mem_headroom_pct or '' }}">
  </div>

  <div class="col-md-3">
    <label class="form-label">ESXi Overhead (GB)</label>
    <input name="esxi_overhead_gb" type="number" step="1" min="0" class="form-control" placeholder="8" value="{{ form.esxi_overhead_gb or '' }}">
  </div>

  <div class="col-md-3">
    <label class="form-label">GPU Sessions Cap per Host</label>
    <input name="gpu_sessions_cap" type="number" min="0" class="form-control" placeholder="0 (no cap)" value="{{ form.gpu_sessions_cap or '' }}">
  </div>

  <!-- =========================
       Regional Mix
  ========================== -->
  <div class="col-12">
    <h5 class="mt-4">Regional Mix (must total 100% if any are selected)</h5>
    <hr class="mt-1">
  </div>

  {% set REGIONS = [
    ('US','Continental US'),
    ('US_HI','US – HI'),
    ('US_AK','US – AK'),
    ('CAN','Canada'),
    ('LATAM','LATAM'),
    ('EMEA','EMEA'),
    ('APAC','APAC'),
    ('INDIA','India'),
    ('ANZ','ANZ'),
    ('OTHER','Other'),
  ] %}

  {% for key,label in REGIONS %}
    <div class="col-md-6 d-flex align-items-center">
      <div class="form-check me-3">
        <input class="form-check-input" type="checkbox" id="region_ck_{{ key }}" name="region_ck_{{ key }}" {% if form['region_ck_' ~ key] %}checked{% endif %}>
        <label class="form-check-label" for="region_ck_{{ key }}">{{ label }}</label>
      </div>
      <div class="input-group">
        <span class="input-group-text">%</span>
        <input name="region_pct_{{ key }}" type="number" min="0" max="100" class="form-control" placeholder="e.g. 60" value="{{ form['region_pct_' ~ key] or '' }}">
      </div>
    </div>
  {% endfor %}

  <!-- =========================
       Operations & Delivery
  ========================== -->
  <div class="col-12">
    <h5 class="mt-4">Operations & Delivery</h5>
    <hr class="mt-1">
  </div>

  <div class="col-md-6">
    <label class="form-label">OGS Staffing</label>
    <input name="ogs_staffing" class="form-control" placeholder="Ops ownership, staffing model..." value="{{ form.ogs_staffing or '' }}">
  </div>

  <div class="col-md-6">
    <label class="form-label">Monitoring Stack</label>
    <input name="monitoring_stack" class="form-control" placeholder="vROps, Grafana, Splunk, ControlUp..." value="{{ form.monitoring_stack or '' }}">
  </div>

  <div class="col-md-3 d-flex align-items-end">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" id="local_printing" name="local_printing" {% if form.local_printing %}checked{% endif %}>
      <label class="form-check-label" for="local_printing">Local Printing? <strong>Yes</strong></label>
    </div>
  </div>

  <div class="col-md-3 d-flex align-items-end">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" id="usb_redirection" name="usb_redirection" {% if form.usb_redirection %}checked{% endif %}>
      <label class="form-check-label" for="usb_redirection">USB Redirection? <strong>Yes</strong></label>
    </div>
  </div>

  <div class="col-12">
    <label class="form-label d-block">Training Required (multi-select)</label>
    <div class="form-check form-check-inline">
      <input class="form-check-input" type="checkbox" name="training_required[]" id="train_admins" value="Admins" {% if 'Admins' in (form.training_required or []) %}checked{% endif %}>
      <label class="form-check-label" for="train_admins">Admins</label>
    </div>
    <div class="form-check form-check-inline">
      <input class="form-check-input" type="checkbox" name="training_required[]" id="train_operators" value="Operators" {% if 'Operators' in (form.training_required or []) %}checked{% endif %}>
      <label class="form-check-label" for="train_operators">Operators</label>
    </div>
    <div class="form-check form-check-inline">
      <input class="form-check-input" type="checkbox" name="training_required[]" id="train_endusers" value="End Users" {% if 'End Users' in (form.training_required or []) %}checked{% endif %}>
      <label class="form-check-label" for="train_endusers">End Users</label>
    </div>
  </div>

  <!-- Keep checkbox = Yes to match current app.py boolean parsing -->
  <div class="col-md-3 d-flex align-items-end">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" id="runbook_required" name="runbook_required" {% if form.runbook_required %}checked{% endif %}>
      <label class="form-check-label" for="runbook_required">Runbook Required? <strong>Yes</strong></label>
    </div>
  </div>

  <div class="col-md-3 d-flex align-items-end">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" id="adoption_services" name="adoption_services" {% if form.adoption_services %}checked{% endif %}>
      <label class="form-check-label" for="adoption_services">Adoption Services? <strong>Yes</strong></label>
    </div>
  </div>

  <div class="col-md-3 d-flex align-items-end">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" id="ha_dr" name="ha_dr" {% if form.ha_dr %}checked{% endif %}>
      <label class="form-check-label" for="ha_dr">HA/DR Required? <strong>Yes</strong></label>
    </div>
  </div>

  <div class="col-md-3">
    <label class="form-label">Delivery Model</label>
    <input name="delivery_model" class="form-control" placeholder="Project / Managed Services / Hybrid" value="{{ form.delivery_model or '' }}">
  </div>

  <div class="col-md-4">
    <label class="form-label">Start Date</label>
    <input name="start_date" type="date" class="form-control" value="{{ form.start_date or '' }}">
  </div>

  <div class="col-md-8">
    <label class="form-label">Timeline Notes</label>
    <input name="timeline" class="form-control" placeholder="Pilot in Q1, rollout Q2–Q3..." value="{{ form.timeline or '' }}">
  </div>

  <!-- =========================
       Documents Requested
  ========================== -->
  <div class="col-12">
    <label class="form-label d-block">Documents Requested (multi-select)</label>

    <!-- Expanded set -->
    {% set DOCS = [
      'Discovery Summary',
      'Executive Summary',
      'Architecture Overview',
      'Implementation Plan',
      'Test Plan',
      'Operations Guide',
      'Runbook',
      'ROM Estimate',
      'SOW Outline',
      'Pre-Deployment Checklist',
      'Project Plan'
    ] %}

    {% for label in DOCS %}
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="docs_requested[]" id="doc_{{ loop.index }}" value="{{ label }}"
               {% if label in (form.docs_requested or []) %}checked{% endif %}>
        <label class="form-check-label" for="doc_{{ loop.index }}">{{ label }}</label>
      </div>
    {% endfor %}
  </div>

  <div class="col-12">
    <label class="form-label">Stakeholders</label>
    <textarea name="stakeholders" class="form-control" rows="2" placeholder="Sponsor, IT lead, app owners, security, networking...">{{ form.stakeholders or '' }}</textarea>
  </div>

  <!-- =========================
       Submit / Cancel
  ========================== -->
  <div class="col-12">
    <div class="d-flex gap-2">
      <button class="btn btn-primary" type="submit">{{ form.entry_id and 'Update' or 'Submit' }}</button>
      <a class="btn btn-outline-secondary" href="{{ url_for('index') }}">Cancel</a>
    </div>
    <div class="form-text mt-2">
      <span class="text-danger">*</span> indicates a required field.
    </div>
  </div>
</form>
{% endblock %}
