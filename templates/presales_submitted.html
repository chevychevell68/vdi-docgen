{% extends "base.html" %}
{% block title %}Submission Saved{% endblock %}
{% block content %}
  <div class="d-flex align-items-center justify-content-between mb-3">
    <h1 class="mb-0">Submission</h1>
    <div class="btn-group">
      <a class="btn btn-outline-secondary" href="{{ url_for('entry_payload', entry_id=data.entry_id) }}">Payload JSON</a>
      <form action="{{ url_for('presales_package') }}" method="post" class="d-inline">
        <input type="hidden" name="payload" value='{{ data | tojson | safe }}'>
        <button class="btn btn-success" type="submit">Build Package</button>
      </form>
      <a class="btn btn-outline-primary" href="{{ url_for('history') }}">Back to History</a>
      <a class="btn btn-primary" href="{{ url_for('index') }}">Home</a>
      <a class="btn btn-warning" href="{{ url_for('presales_edit', entry_id=data.entry_id) }}">Edit</a>
    </div>
  </div>

  <div class="alert alert-success">Saved as Entry ID: <strong>{{ data.entry_id }}</strong></div>

  <div class="row">
    <div class="col-lg-6">
      <div class="card mb-3">
        <div class="card-body">
          <h5 class="card-title">Summary</h5>
          <ul class="mb-0">
            <li><strong>Company:</strong> {{ data.company_name or '—' }}</li>
            <li>
              <strong>Opportunity:</strong>
              {% if data.sf_opportunity_url %}
                <a href="{{ data.sf_opportunity_url }}" target="_blank" rel="noopener">{{ data.sf_opportunity_name or data.sf_opportunity_url }}</a>
              {% else %}
                {{ data.sf_opportunity_name or '—' }}
              {% endif %}
            </li>
            <li><strong>IR:</strong> {{ data.ir_number or '—' }}</li>
            <li><strong>Submitted (UTC):</strong> <code>{{ data.submitted_utc }}</code>
              {% if data.updated_utc %}<span class="text-muted ms-2">(Updated: {{ data.updated_utc }})</span>{% endif %}
            </li>
            <li><strong>Docs Requested:</strong> {{ (data.docs_requested or []) | join(', ') if data.docs_requested else '—' }}</li>
          </ul>
        </div>
      </div>
    </div>
    <div class="col-lg-6">
      <div class="card mb-3">
        <div class="card-body">
          <h5 class="card-title">Location Mix</h5>
          <pre class="mb-0 bg-light p-2 border rounded">{{ (data.location_mix or {}) | tojson(indent=2) }}</pre>
        </div>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-body">
      <h5 class="card-title">Full Payload</h5>
      <pre class="mb-0 bg-light p-2 border rounded">{{ data | tojson(indent=2) }}</pre>
    </div>
  </div>
{% endblock %}
